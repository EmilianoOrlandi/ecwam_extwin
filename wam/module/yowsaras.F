      MODULE YOWSARAS

      IMPLICIT NONE

      INTEGER, PARAMETER :: MPARTSW = 18

      REAL, PARAMETER :: PPSARCF = 1.8
      REAL, PARAMETER :: PPSDM = 1.

      INTEGER :: NSPEC
      INTEGER :: NSPECW
      INTEGER :: JPSIW
      INTEGER :: MAXMPART=0

      INTEGER, PARAMETER :: NSARINVI = 2
      INTEGER, PARAMETER :: NSARINVR = 9
      INTEGER :: NSAR 

      INTEGER, ALLOCATABLE :: NW1D(:,:)
      INTEGER, ALLOCATABLE :: NIGW(:)
      INTEGER, ALLOCATABLE :: NIJW(:)
      INTEGER, ALLOCATABLE :: NTOSIW1D(:)
      INTEGER, ALLOCATABLE :: NSIW1D(:,:)
      INTEGER, ALLOCATABLE :: IGSAR(:) 
      INTEGER, ALLOCATABLE :: IJSAR(:) 

      INTEGER, ALLOCATABLE :: ISARINV(:,:)

      REAL :: SARCORDIA

      REAL, ALLOCATABLE :: SPEC(:,:,:,:)
      REAL, ALLOCATABLE :: LONG(:,:)
      REAL, ALLOCATABLE :: LAT(:,:)
      REAL, ALLOCATABLE :: XKLOW(:)
      REAL, ALLOCATABLE :: XKUP(:)
      REAL, ALLOCATABLE :: XKCUTOFF(:)
      REAL, ALLOCATABLE :: COSSARLAT(:)
      REAL, ALLOCATABLE :: SINSARLAT(:)
      REAL, ALLOCATABLE :: U10(:)
      REAL, ALLOCATABLE :: USSAR(:)
      REAL, ALLOCATABLE :: THW(:)

      REAL, ALLOCATABLE :: SPECW(:,:,:)
      REAL, ALLOCATABLE :: DIST(:,:)
      REAL, ALLOCATABLE :: UW10(:)
      REAL, ALLOCATABLE :: USW(:)
      REAL, ALLOCATABLE :: THWW(:)

      REAL, ALLOCATABLE :: RSARINV(:,:)
      REAL, ALLOCATABLE :: DUVSAR(:,:)


!     VARIABLE   TYPE     PURPOSE                                  
!     --------   ----     -------                                  
!     *MPARTSW*  INTEGER  MAXIMUM NUMBER OF PARTITIONINGS (for arrays).
!     *PPSARCF   REAL     PPSARCF*SARCORDIA IS THE MAXIMUM INFLUENCE
!                         DISTANCE FOR THE SAR ASSIMILATION. 
!     *PPSDM*    REAL     RATIO SIGMA_OBS/SIGMA_FG.

!     *NSPEC*    INTEGER  NUMBER OF VALID OBSERVATIONS.
!     *MSPECW*   INTEGER  MAXIMUM NUMBER OF ANALYSED POINTS.
!     *JPSIW*    INTEGER  MAXIMUM  NUMBER OF SAR POINTS INFLUENCING
!                         ONE WAM POINT.
!     *MAXMPART  INTEGER  MAXIMUM NUMBER OF PARTITIONINGS USED AFTER
!                         PARTITIONING OF SAR AND MODEL SPECTRA. 
!     *NSARINVI  INTEGER  NUMBER OF INTEGER PARAMETERS COLLECTED FROM
!                         THE SAR INVERSION IN WAM.
!     *NSARINVR  INTEGER  NUMBER OF REAL PARAMETERS COLLECTED FROM
!                         THE SAR INVERSION IN WAM BESIDE THE SPECTRA.
!     *NSAR      INTEGER  TOTAL OF SAR SPECTRA INVERTED BY WAM.
!     *NW1D*     INTEGER  INDEX IN THE 1D ARRAY OF MODEL POINTS 
!                         INFLUENCED BY THE SAR DATA POINTS FOR EACH
!                         WAM POINT ( referred to by its block indices)
!                         =0 FOR POINTS NOT INFLUENCED BY DATA POINT.
!     *NIGW*     INTEGER  BLOCK INDEX OF POINT IN 1D ARRAY.
!     *NIJW*     INTEGER  INDEX IN A BLOCK OF POINT IN 1D ARRAY.
!     *NTOSIW1D* INTEGER  NUMBER OF SAR DATA POINTS INFLUENCING A WAM
!                         POINT INDEXED IN THE 1D ARRAY.
!     *NSIW1D*   INTEGER  INDEX OF THE SAR SPECTRUM IN THE SAR DATA
!                         ARRAY IFLUENCING THE WAM POINT INDEXED IN THE
!                         1D ARRAY.
!     *IGSAR*    INTEGER  BLOCK NUMBER OF THE CLOSEST MODEL SEA POINT
!                         O will indicate that it is outside the model
!                         sea point grid. 
!     *IJSAR*    INTEGER  BLOCK INDEX OF THE CLOSEST MODEL SEA POINT
!                         O will indicate that it is outside the model
!                         sea point grid. 
!     *SARINV*   INTEGER  ARRAY CONTAINING THE INTEGER PARAMETERS NEEDED
!                         FOR THE SAR ASSIMILATION OBTAINED FROM THE SAR
!                         INVERSION FROM WITHIN WAM.
!     *SARCORDIA*REAL     SAR MODEL MAXIMUM CORRELATION DISTANCE in m 
!     *SPEC*     REAL     INPUT SAR SPECTRA FOR FIRST GUESS SPECTRUM = 1
!                         SAR RETRIEVED SPECTRUM = 2.
!     *LONG*     REAL     LONGITUDE OF SPEC (IN DEGREE).
!     *LAT*      REAL     LATITUDE OF SPEC (IN DEGREE).
!     *XKLOW*    REAL     LOWER SAR WAVE NUMBER BOUNDARY.     
!     *XKUP*     REAL     UPPER SAR WAVE NUMBER BOUNDARY. 
!     *XKCUTOFF* REAL     CUT OFF WAVE LENGHT FROM THE SAR INVERSION.
!     *COSSARLAT*REAL     COSINE OF LAT.
!     *SINSARLAT*REAL     SINE OF LAT.
!     *U10*      REAL     FIRST GUESS U10 AT SPEC LOCATION. 
!     *USSAR*    REAL     FIRST GUESS USTAR AT SPEC LOCATION. 
!     *THW*      REAL     FIRST GUESS WIND DIRECTION AT SPEC LOCATION. 
!     *SPECW*    REAL     WAM SPECTRA TO BE ANALYSED.
!     *DIST*     REAL     DISTANCE BETWEEN WAM AND SAR POINT
!                         INFLUENCING WAM POINT.
!     *UW10*     REAL     WIND SPEED AT XLATW,XLONW. 
!     *USW*      REAL     USTAR AT XLATW,XLONW. 
!     *THWW*     REAL     WIND DIRECTION  AT XLATW,XLONW. 
!     *RSARINV*  REAL     ARRAY CONTAINING THE REAL PARAMETERS NEEDED
!                         FOR THE SAR ASSIMILATION OBTAINED FROM THE SAR
!                         INVERSION FROM WITHIN WAM INCLUDING THE
!                         SPECTRA.
!     *DUVSAR*   REAL     ARRAY CONTAINING THE INCREMENTS TO THE
!                         WIND SPEED COMPONENTS DUE TO THE SAR.
! ----------------------------------------------------------------------
      END MODULE YOWSARAS
