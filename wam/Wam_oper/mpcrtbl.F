      SUBROUTINE MPCRTBL 

! ----------------------------------------------------------------------

!**** *MPCRTBL* -

!     J. BIDLOT     ECMWF    MARCH 1996    MESSAGE PASSING


!*    PURPOSE.
!     --------
!     CREATE A TABLE THAT ASSOCIATES EACH INTEGRATED OUTPUT PARAMETER
!     WITH A SPECIFIC PROCESS. THIS TABLE IS USED TO SPREAD THE
!     RETRIEVAL OF THOSE PARAMETER FIELD IN GRID FORMAT ON AS MANY 
!     PROCESSOR AS POSSIBLE

!     IT ALSo SETS THE RELEVANT INFORMATIOn FOR GRIB ENCODING.

!**   INTERFACE.
!     ----------


!     METHOD.
!     -------
!     SYSTEMATICALY ASSIGN A PROCESS TO A PARAMETER AND START AGAIN WHEN
!     RUN OUT OF PROCESS.

!     EXTERNALS.
!     ----------
!       NONE.

!     REFERENCE.
!     ----------

!       NONE.

! ----------------------------------------------------------------------

      USE YOWCOUP  , ONLY : XNLEV
      USE YOWCOUT  , ONLY : JPPFLAG  ,FFLAG    ,PFLAG    ,GFLAG    ,    &
     &            NFLAG    ,IPFGTBL  ,NWRTOUTWAM, COUTNAME, NIPRMOUT,   &
     &            ITOBOUT  ,NTRAIN   ,LLPARTITION, NIPRMINFO, IPRMINFO, &
     &            IFRSTPARTI
!      *IPRMINFO* INTEGER    AUXILIARY INFORMATION FOR OUTPUT OF INTEGRATED PARAMETERS
!                            IPRMINFO(:,1)  : GRIB TABLE NUMBER.
!                            IPRMINFO(:,2)  : GRIB PARAMETER IDENTIFIER.
!                            IPRMINFO(:,3)  : GRIB REFERENCE LEVEL IN FULL METER.
!                            IPRMINFO(:,4)  : 1 IF SEA ICE MASK IS IMPOSED ON OUTPUT FIELD.
!                            IPRMINFO(:,5)  : 1 IF TOO SHALLOW POINTS ARE SET TO MISSING.

      USE YOWMPP   , ONLY : NPROC
      USE YOWSTAT  , ONLY : IASSI

! ----------------------------------------------------------------------
      IMPLICIT NONE

      INTEGER :: IR, IFLAG, IC, ITG, ITT, IZLEV, IR

!     1. CREATE TABLE MAPPING OUTPUT INTEGRATED PARAMETER WITH PE RANK
!        -------------------------------------------------------------

      IZLEV=NINT(XNLEV(1))

      IR=0
      COUTNAME(:) =' VARIABLE NOT DEFINED, see MPCRTBL'
      IPRMINFO(:,:)=0

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' SIGNIFICANT WAVE HEIGHT .........'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=229
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' MEAN WAVE DIRECTION .............'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=230
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1


      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' WAVE MEAN PERIOD (-1) ...........'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=232
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' FRICTION VELOCITY ...............'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=084
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=0
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' WAVE MODEL WIND DIRECTION........'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=249
      IPRMINFO(IR,3)=IZLEV
      IPRMINFO(IR,4)=0
      IPRMINFO(IR,5)=0

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' WAVE PEAK PERIOD ................'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=231
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' DRAG COEFFICIENT ................'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=233
      IPRMINFO(IR,3)=IZLEV
      IPRMINFO(IR,4)=0
      IPRMINFO(IR,5)=0

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' WAVE STRESS ....................'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=083
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=0
      IPRMINFO(IR,5)=1


      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' MEAN SQUARE SLOPE................'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=244
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' WAVE MODEL WIND SPEED............'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=245
      IPRMINFO(IR,3)=IZLEV
      IPRMINFO(IR,4)=0
      IPRMINFO(IR,5)=0

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' WIND SEA WAVE HEIGHT.............'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=234
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' TOTAL SWELL WAVE HEIGHT..........'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=237
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' WIND SEA MEAN DIRECTION..........'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=235
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' TOTAL SWELL WAVE MEAN DIRECTION..'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=238
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' WIND SEA MEAN PERIOD (-1) .......'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=236
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' TOTAL SWELL MEAN PERIOD (-1) ....'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=239
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' ALTIMETER WAVE HEIGHT ...........'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=246
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' CORRECTED ALT WAVE HEIGHT .......'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=247
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' ALTIMETER RANGE CORRECTION ......'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=248
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' WAVE MEAN PERIOD (1) ............'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=220
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' WAVE MEAN PERIOD (2) ............'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=221
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' WAVE DIRECTIONAL SPREAD .........'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=222
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' WIND SEA MEAN PERIOD (1) ........'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=223
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' TOTAL SWELL MEAN PERIOD (1) .....'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=226
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' WIND SEA MEAN PERIOD (2) ........'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=224
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' TOTAL SWELL MEAN PERIOD (2) .....'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=227
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' WIND SEA DIRECTIONAL SPREAD......'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=225
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' TOTAL SWELL DIRECTIONAL SPREAD ..'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=228
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' WAVE SPECTRAL KURTOSIS ..........'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=252
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' BENJAMIN-FEIR INDEX .............'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=253
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' WAVE SPECTRAL PEAKEDNESS ........'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=254
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' BATHYMETRY ......................'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=219
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=0
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' MAXIMUM WAVE HEIGHT .............'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=218
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' MAXIMUM WAVE PERIOD .............'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=217
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' U-COMP SURFACE STOKES DRIFT .....'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=215
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' V-COMP SURFACE STOKES DRIFT .....'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=216
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' U-COMP SURFACE CURRENT ..........'
      IPRMINFO(IR,1)=151
      IPRMINFO(IR,2)=131
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=0
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' V-COMP SURFACE CURRENT ..........'
      IPRMINFO(IR,1)=151
      IPRMINFO(IR,2)=132
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=0
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' NORMALISED ENERGY FLUX TO OCEAN .'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=212
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=0
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' NORMALISED ENERGY FLUX TO WAVES .'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=211
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=0
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' NORMALISED MOMENTUM FLUX TO OCEAN'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=214
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=0
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' SWELL PARTITION 1 WAVE HEIGHT ...'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=121
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1
!     swell partition index:
      IFRSTPARTI=IR

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' SWELL PARTITION 1 DIRECTION .....'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=122
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' SWELL PARTITION 1 MEAN PERIOD ...'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=123
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' SWELL PARTITION 2 WAVE HEIGHT ...'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=124
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' SWELL PARTITION 2 DIRECTION .....'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=125
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' SWELL PARTITION 2 MEAN PERIOD ...'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=126
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' SWELL PARTITION 3 WAVE HEIGHT ...'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=127
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' SWELL PARTITION 3 DIRECTION .....'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=128
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' SWELL PARTITION 3 MEAN PERIOD ...'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=129
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' MEAN SQUARE STRAIN IN ICE .......'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=210
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=0
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' WAVE HEIGHT WITH PERIOD > 10s ...'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=120
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' SURFACE AIR DENSITY .............'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=209
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=0
      IPRMINFO(IR,5)=0

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' CONVECTIVE VELOCITY SCALE........'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=208
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=0
      IPRMINFO(IR,5)=0

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' SEA ICE COVER ...................'
      IPRMINFO(IR,1)=128
      IPRMINFO(IR,2)=31
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=0
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' SEA ICE THICKNESS ...............'
      IPRMINFO(IR,1)=3
      IPRMINFO(IR,2)=92
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=0
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' SPECTRAL SKWENESS ...............'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=207
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' NEMO SST ........................'
      IPRMINFO(IR,1)=151
      IPRMINFO(IR,2)=159
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=0
      IPRMINFO(IR,5)=0

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' NEMO SEA ICE COVER ..............'
      IPRMINFO(IR,1)=3
      IPRMINFO(IR,2)=91
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=0
      IPRMINFO(IR,5)=0

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' NEMO SEA ICE THICKNESS ..........'
      IPRMINFO(IR,1)=3
      IPRMINFO(IR,2)=92
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=0
      IPRMINFO(IR,5)=0

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' NEMO ZONAL CURRENT ..............'
      IPRMINFO(IR,1)=3
      IPRMINFO(IR,2)=49
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=0
      IPRMINFO(IR,5)=0

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' NEMO MERIDIONAL CURRENT .........'
      IPRMINFO(IR,1)=3
      IPRMINFO(IR,2)=50
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=0
      IPRMINFO(IR,5)=0

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' WAVE ENERGY FLUX MAGNITUDE ......'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=112
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' WAVE ENERGY FLUX DIRECTION ......'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=113
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' SIG. WAVE HEIGHT 10<=T<=12 ......'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=114
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' SIG. WAVE HEIGHT 12<=T<=14 ......'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=115
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' SIG. WAVE HEIGHT 14<=T<=17 ......'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=116
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' SIG. WAVE HEIGHT 17<=T<=21 ......'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=117
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' SIG. WAVE HEIGHT 21<=T<=25 ......'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=118
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
      COUTNAME(IR)=' SIG. WAVE HEIGHT 25<=T<=30 ......'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=119
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

!     add new definition here:



      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG-5 IN MPCRTBL')
      DO IC=1,5
        ITG=JPPFLAG-5+IC
        COUTNAME(ITG)=' EXTRA FIELD .....................'
        IPRMINFO(ITG,1)=140
        IPRMINFO(ITG,2)=79+IC
        IPRMINFO(ITG,3)=0
        IPRMINFO(ITG,4)=0
        IPRMINFO(ITG,5)=0
      ENDDO


      NIPRMOUT=0

      IR=1
      DO IFLAG=1,JPPFLAG
        IF((IASSI.EQ.1).AND.
     &     ((IFLAG.EQ.1).OR.(IFLAG.EQ.7))) THEN                         &
          IPFGTBL(IFLAG)=IR
          NIPRMOUT=NIPRMOUT+1
          ITOBOUT(IFLAG)=NIPRMOUT
          IR=IR+NWRTOUTWAM
          IF(IR.GT.NPROC) IR=1
        ELSEIF(PFLAG(IFLAG).OR.FFLAG(IFLAG).OR.GFLAG(IFLAG).OR.         &
     &         NFLAG(IFLAG) ) THEN
          IPFGTBL(IFLAG)=IR
          NIPRMOUT=NIPRMOUT+1
          ITOBOUT(IFLAG)=NIPRMOUT
          IR=IR+NWRTOUTWAM
          IF(IR.GT.NPROC) IR=1
        ELSE
          IPFGTBL(IFLAG)=0
          ITOBOUT(IFLAG)=0
        ENDIF
      ENDDO

!     WILL THERE BE OUTPUT OF PARTITONED PARAMETERS
      LLPARTITION=.FALSE.
      IFLAG=IFRSTPARTI
      DO ITT=1,3*NTRAIN
        IF(IPFGTBL(IFLAG).NE.0) THEN
          LLPARTITION=.TRUE.
          EXIT
        ENDIF
        IFLAG=IFLAG+1
      ENDDO


! FIND P.E. FOR OUTPUT OF RESTART FILES

      IFLAG=JPPFLAG
!c
!cc set to 1 in order to simplify ouput to FDB
      IPFGTBL(JPPFLAG+1)=1

!!!     DO WHILE ((IPFGTBL(IFLAG).EQ.0).AND.(IFLAG.GT.1))
!!!         IFLAG=IFLAG-1
!!!      END DO
!!!      IPFGTBL(JPPFLAG+1)=IPFGTBL(IFLAG)+1
!!!      IF(IPFGTBL(JPPFLAG+1).GT.NPROC)IPFGTBL(JPPFLAG+1)=1

      END SUBROUTINE MPCRTBL
