      SUBROUTINE MPCRTBL 

! ----------------------------------------------------------------------

!**** *MPCRTBL* -

!     J. BIDLOT     ECMWF    MARCH 1996    MESSAGE PASSING


!*    PURPOSE.
!     --------
!     CREATE A TABLE THAT ASSOCIATES EACH INTEGRATED OUTPUT PARAMETER
!     WITH A SPECIFIC PROCESS. THIS TABLE IS USED TO SPREAD THE
!     RETRIEVAL OF THOSE PARAMETER FIELD IN GRID FORMAT ON AS MANY 
!     PROCESSOR AS POSSIBLE

!     IT ALSO SETS THE RELEVANT INFORMATION FOR GRIB ENCODING.

!**   INTERFACE.
!     ----------


!     METHOD.
!     -------
!     SYSTEMATICALY ASSIGN A PROCESS TO A PARAMETER AND START AGAIN WHEN
!     RUN OUT OF PROCESS.

!     EXTERNALS.
!     ----------
!       NONE.

!     REFERENCE.
!     ----------

!       NONE.

! ----------------------------------------------------------------------

      USE YOWCOUP  , ONLY : XNLEV
      USE YOWCOUT  , ONLY : JPPFLAG  ,FFLAG    ,GFLAG    ,NFLAG     ,   &
     &            IPFGTBL  ,NWRTOUTWAM, COUTNAME, NIPRMOUT,ITOBOUT  ,   &
     &            NTRAIN   ,LLPARTITION,NIPRMINFO,IPRMINFO          ,   &
     &            IRWDIR, IRCD ,IRU10  , IRALTHS ,IRALTHSC ,IRALTRC ,   &
     &            IRHS     ,IRTP     ,IRT1     ,IRPHIOC  ,IRTAUOC   ,   &
     &            IRHSWS   ,IRT1WS   ,IRBATHY  ,                        &
     &            IFRSTPARTI, NINFOBOUT,INFOBOUT  ,BOUT
!      *IPRMINFO* INTEGER    AUXILIARY INFORMATION FOR OUTPUT OF INTEGRATED PARAMETERS
!                            IPRMINFO(:,1)  : GRIB TABLE NUMBER.
!                            IPRMINFO(:,2)  : GRIB PARAMETER IDENTIFIER.
!                            IPRMINFO(:,3)  : GRIB REFERENCE LEVEL IN FULL METER.
!                            IPRMINFO(:,4)  : 1 IF SEA ICE MASK IS IMPOSED ON OUTPUT FIELD.
!                            IPRMINFO(:,5)  : 1 IF TOO SHALLOW POINTS ARE SET TO MISSING.
      USE YOWGRID  , ONLY : IJSLOC   ,IJLLOC
      USE YOWMPP   , ONLY : NPROC
      USE YOWTEST  , ONLY : IU06

! ----------------------------------------------------------------------
      IMPLICIT NONE

      INTEGER :: IR, IFLAG, IT, IC, ITG, ITP, ITT, IZLEV

!     1. CREATE TABLE MAPPING OUTPUT INTEGRATED PARAMETER WITH PE RANK
!        -------------------------------------------------------------

      IZLEV=NINT(XNLEV(1))

      IR=0
      COUTNAME(:) =' VARIABLE NOT DEFINED, see MPCRTBL'
      IPRMINFO(:,:)=0

      IR=IR+1
!     PARAMETER 001
      IRHS=IR
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' SIGNIFICANT WAVE HEIGHT .........'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=229
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 002
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' MEAN WAVE DIRECTION .............'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=230
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 003
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' WAVE MEAN PERIOD (-1) ...........'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=232
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 004
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' FRICTION VELOCITY ...............'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=084   !!! use a spare extra parameter number
      IF(GFLAG(IR) ) THEN
        WRITE(IU06,*) ' ******************* NOTE ********************'
        WRITE(IU06,*) ' GRIB OUTPUT POSSIBLE FOR ', COUTNAME(IR)
        WRITE(IU06,*) ' USING SPARE PARAMETER NUMBER ', IPRMINFO(IR,2)
        WRITE(IU06,*) ' '
      ENDIF
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=0
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 005
      IRWDIR=IR
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' WAVE MODEL WIND DIRECTION........'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=249
      IPRMINFO(IR,3)=IZLEV
      IPRMINFO(IR,4)=0
      IPRMINFO(IR,5)=0

      IR=IR+1
!     PARAMETER 006
      IRTP=IR
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' WAVE PEAK PERIOD ................'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=231
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 007
      IRCD=IR
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' DRAG COEFFICIENT ................'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=233
      IPRMINFO(IR,3)=IZLEV
      IPRMINFO(IR,4)=0
      IPRMINFO(IR,5)=0

      IR=IR+1
!     PARAMETER 008
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' WAVE STRESS ....................'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=083   !!! use a spare extra parameter number
      IF(GFLAG(IR) ) THEN
        WRITE(IU06,*) ' ******************* NOTE ********************'
        WRITE(IU06,*) ' GRIB OUTPUT POSSIBLE FOR ', COUTNAME(IR)
        WRITE(IU06,*) ' USING SPARE PARAMETER NUMBER ', IPRMINFO(IR,2)
        WRITE(IU06,*) ' '
      ENDIF
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=0
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 009
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' MEAN SQUARE SLOPE................'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=244
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 010
      IRU10=IR
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' WAVE MODEL WIND SPEED............'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=245
      IPRMINFO(IR,3)=IZLEV
      IPRMINFO(IR,4)=0
      IPRMINFO(IR,5)=0

      IR=IR+1
!     PARAMETER 011
      IRHSWS=IR
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' WIND SEA WAVE HEIGHT.............'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=234
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 012
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' TOTAL SWELL WAVE HEIGHT..........'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=237
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 013
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' WIND SEA MEAN DIRECTION..........'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=235
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 014
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' TOTAL SWELL WAVE MEAN DIRECTION..'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=238
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 015
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' WIND SEA MEAN PERIOD (-1) .......'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=236
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 016
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' TOTAL SWELL MEAN PERIOD (-1) ....'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=239
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 017
      IRALTHS=IR
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' ALTIMETER WAVE HEIGHT ...........'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=246
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 018
      IRALTHSC=IR
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' CORRECTED ALT WAVE HEIGHT .......'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=247
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 019
      IRALTRC=IR
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' ALTIMETER RANGE CORRECTION ......'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=248
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 020
      IRT1=IR
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' WAVE MEAN PERIOD (1) ............'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=220
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 021
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' WAVE MEAN PERIOD (2) ............'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=221
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 022
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' WAVE DIRECTIONAL SPREAD .........'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=222
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 023
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' WIND SEA MEAN PERIOD (1) ........'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=223
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 024
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' TOTAL SWELL MEAN PERIOD (1) .....'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=226
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 025
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' WIND SEA MEAN PERIOD (2) ........'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=224
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 026
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' TOTAL SWELL MEAN PERIOD (2) .....'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=227
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 027
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' WIND SEA DIRECTIONAL SPREAD......'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=225
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 028
      IRT1WS=IR
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' TOTAL SWELL DIRECTIONAL SPREAD ..'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=228
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 029
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' WAVE SPECTRAL KURTOSIS ..........'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=252
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 030
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' BENJAMIN-FEIR INDEX .............'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=253
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 031
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' WAVE SPECTRAL PEAKEDNESS ........'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=254
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 032
      IRBATHY=IR
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' BATHYMETRY ......................'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=219
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=0
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 033
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' MAXIMUM WAVE HEIGHT .............'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=218
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 034
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' MAXIMUM WAVE PERIOD .............'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=217
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 035
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' U-COMP SURFACE STOKES DRIFT .....'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=215
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 036
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' V-COMP SURFACE STOKES DRIFT .....'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=216
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 037
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' U-COMP SURFACE CURRENT ..........'
      IPRMINFO(IR,1)=151
      IPRMINFO(IR,2)=131
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=0
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 038
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' V-COMP SURFACE CURRENT ..........'
      IPRMINFO(IR,1)=151
      IPRMINFO(IR,2)=132
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=0
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 039
      IRPHIOC=IR
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' NORMALISED ENERGY FLUX TO OCEAN .'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=212
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=0
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 040
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' NORMALISED ENERGY FLUX TO WAVES .'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=211
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=0
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 041
      IRTAUOC=IR
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' NORMALISED MOMENTUM FLUX TO OCEAN'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=214
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=0
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 042
      ITP=0 ! total number of partitions parameters
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' SWELL PARTITION 1 WAVE HEIGHT ...'
      ITP=ITP+1
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=121
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1
!     swell partition index:
      IFRSTPARTI=IR

      IR=IR+1
!     PARAMETER 043
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' SWELL PARTITION 1 DIRECTION .....'
      ITP=ITP+1
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=122
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 044
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' SWELL PARTITION 1 MEAN PERIOD ...'
      ITP=ITP+1
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=123
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 045
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' SWELL PARTITION 2 WAVE HEIGHT ...'
      ITP=ITP+1
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=124
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 046
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' SWELL PARTITION 2 DIRECTION .....'
      ITP=ITP+1
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=125
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 047
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' SWELL PARTITION 2 MEAN PERIOD ...'
      ITP=ITP+1
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=126
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 048
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' SWELL PARTITION 3 WAVE HEIGHT ...'
      ITP=ITP+1
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=127
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 049
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' SWELL PARTITION 3 DIRECTION .....'
      ITP=ITP+1
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=128
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 050
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' SWELL PARTITION 3 MEAN PERIOD ...'
      ITP=ITP+1
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=129
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 051
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' MEAN SQUARE STRAIN IN ICE .......'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=210
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=0
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 052
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' WAVE HEIGHT WITH PERIOD > 10s ...'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=120
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 053
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' SURFACE AIR DENSITY .............'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=209
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=0
      IPRMINFO(IR,5)=0

      IR=IR+1
!     PARAMETER 054
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' CONVECTIVE VELOCITY SCALE........'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=208
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=0
      IPRMINFO(IR,5)=0

      IR=IR+1
!     PARAMETER 055
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' SEA ICE COVER ...................'
      IPRMINFO(IR,1)=128
      IPRMINFO(IR,2)=31
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=0
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 056
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' SEA ICE THICKNESS ...............'
      IPRMINFO(IR,1)=3
      IPRMINFO(IR,2)=92
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=0
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 057
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' SPECTRAL SKWENESS ...............'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=207
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 058
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' NEMO SST ........................'
      IPRMINFO(IR,1)=151
      IPRMINFO(IR,2)=159
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=0
      IPRMINFO(IR,5)=0

      IR=IR+1
!     PARAMETER 059
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' NEMO SEA ICE COVER ..............'
      IPRMINFO(IR,1)=3
      IPRMINFO(IR,2)=91
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=0
      IPRMINFO(IR,5)=0

      IR=IR+1
!     PARAMETER 060
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' NEMO SEA ICE THICKNESS ..........'
      IPRMINFO(IR,1)=3
      IPRMINFO(IR,2)=92
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=0
      IPRMINFO(IR,5)=0

      IR=IR+1
!     PARAMETER 061
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' NEMO ZONAL CURRENT ..............'
      IPRMINFO(IR,1)=3
      IPRMINFO(IR,2)=49
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=0
      IPRMINFO(IR,5)=0

      IR=IR+1
!     PARAMETER 062
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' NEMO MERIDIONAL CURRENT .........'
      IPRMINFO(IR,1)=3
      IPRMINFO(IR,2)=50
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=0
      IPRMINFO(IR,5)=0

      IR=IR+1
!     PARAMETER 063
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' WAVE ENERGY FLUX MAGNITUDE ......'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=112
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 064
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' WAVE ENERGY FLUX DIRECTION ......'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=113
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 065
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' SIG. WAVE HEIGHT 10<=T<=12 ......'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=114
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 066
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' SIG. WAVE HEIGHT 12<=T<=14 ......'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=115
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 067
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' SIG. WAVE HEIGHT 14<=T<=17 ......'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=116
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 068
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' SIG. WAVE HEIGHT 17<=T<=21 ......'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=117
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 069
      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG IN MPCRTBL')
      COUTNAME(IR)=' SIG. WAVE HEIGHT 21<=T<=25 ......'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=118
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

      IR=IR+1
!     PARAMETER 070
      COUTNAME(IR)=' SIG. WAVE HEIGHT 25<=T<=30 ......'
      IPRMINFO(IR,1)=140
      IPRMINFO(IR,2)=119
      IPRMINFO(IR,3)=0
      IPRMINFO(IR,4)=1
      IPRMINFO(IR,5)=1

!     add new definition here:
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!



      IF(IR.GT.JPPFLAG) CALL MPABORT('IR > JPPFLAG-5 IN MPCRTBL')
      DO IC=1,5
        ITG=JPPFLAG-5+IC
        COUTNAME(ITG)=' EXTRA FIELD .....................'
        IPRMINFO(ITG,1)=140
        IPRMINFO(ITG,2)=79+IC
        IPRMINFO(ITG,3)=0
        IPRMINFO(ITG,4)=0
        IPRMINFO(ITG,5)=0
      ENDDO


!     DETERMINE THE PROCERSSORS THAT WILL CARRY OUT THE OUTPUT
      NIPRMOUT=0
      IR=1
      DO IFLAG=1,JPPFLAG
        IF(FFLAG(IFLAG).OR.GFLAG(IFLAG).OR.NFLAG(IFLAG)) THEN

          IF(FFLAG(IFLAG)) THEN
!!!!        IN CASE OF NON GRIB OUTPUT, REDIRECT TO PE 1 
            IPFGTBL(IFLAG)=1
          ELSE
            IPFGTBL(IFLAG)=IR
          ENDIF

          NIPRMOUT=NIPRMOUT+1
          ITOBOUT(IFLAG)=NIPRMOUT

          IR=IR+NWRTOUTWAM
          IF(IR.GT.NPROC) IR=1
        ELSE
          IPFGTBL(IFLAG)=0
          ITOBOUT(IFLAG)=0
        ENDIF
      ENDDO

      IF(NIPRMOUT>0) THEN
        IF(ALLOCATED(BOUT)) DEALLOCATE(BOUT)
        ALLOCATE(BOUT(IJSLOC:IJLLOC,NIPRMOUT))
        IF(ALLOCATED(INFOBOUT)) DEALLOCATE(INFOBOUT)
        ALLOCATE(INFOBOUT(NIPRMOUT,NINFOBOUT))
        DO IFLAG=1,JPPFLAG
          IT=ITOBOUT(IFLAG)
          IF(IT.GT.0) THEN
            INFOBOUT(IT,1)=IPRMINFO(IFLAG,1)
            INFOBOUT(IT,2)=IPRMINFO(IFLAG,2)
            INFOBOUT(IT,3)=IPRMINFO(IFLAG,3)
          ENDIF
        ENDDO
      ENDIF

!     WILL THERE BE OUTPUT OF PARTITONED PARAMETERS
      IF(NTRAIN*(ITP/NTRAIN).NE.ITP) THEN
        WRITE(0,*) '******************************************'
        WRITE(0,*) '*  FATAL ERROR IN SUB. MPCRTBL           *'
        WRITE(0,*) '*  THE NUMBER OF PARTITONED PARAMETERS   *'
        WRITE(0,*) '*  DOES NOT MATCH !!!!                   *'
        WRITE(0,*) '*  NTRAIN = ',NTRAIN
        WRITE(0,*) '*  ITP = ',ITP
        WRITE(0,*) '******************************************'
        WRITE(IU06,*) '******************************************'
        WRITE(IU06,*) '*  FATAL ERROR IN SUB. MPCRTBL           *'
        WRITE(IU06,*) '*  THE NUMBER OF PARTITONED PARAMETERS   *'
        WRITE(IU06,*) '*  DOES NOT MATCH !!!!                   *'
        WRITE(IU06,*) '*  NTRAIN = ',NTRAIN
        WRITE(IU06,*) '*  ITP = ',ITP
        WRITE(IU06,*) '******************************************'
        CALL ABORT1
      ENDIF
      LLPARTITION=.FALSE.
      IFLAG=IFRSTPARTI
      DO ITT=1,ITP
        IF(IPFGTBL(IFLAG).NE.0) THEN
          LLPARTITION=.TRUE.
          EXIT
        ENDIF
        IFLAG=IFLAG+1
      ENDDO


! FIND P.E. FOR OUTPUT OF RESTART FILES
!c
!cc set to 1 in order to simplify ouput to FDB
      IPFGTBL(JPPFLAG+1)=1

!!!      IFLAG=JPPFLAG
!!!     DO WHILE ((IPFGTBL(IFLAG).EQ.0).AND.(IFLAG.GT.1))
!!!         IFLAG=IFLAG-1
!!!      END DO
!!!      IPFGTBL(JPPFLAG+1)=IPFGTBL(IFLAG)+1
!!!      IF(IPFGTBL(JPPFLAG+1).GT.NPROC)IPFGTBL(JPPFLAG+1)=1

      END SUBROUTINE MPCRTBL
