      SUBROUTINE WVALLOC(LWCUR)

! ----------------------------------------------------------------------

!**** *WVALLOC* - WAVE MODEL ARRAY ALLOCATION

! ----------------------------------------------------------------------

      USE PARKIND_WAVE, ONLY : JWIM, JWRB, JWRU

      USE YOWCOUP  , ONLY : LWCOU
      USE YOWCURR  , ONLY : U        ,V
      USE YOWICE   , ONLY : CICOVER  ,CITHICK  ,CIWA
      USE YOWMEAN  , ONLY : PHIEPS   ,                                  &
     &                      USTOKES  ,VSTOKES  ,STRNMS   ,              &
     &                      PHIAW    ,TAUOC    ,TAUXD    ,TAUYD    ,    &
     &                      TAUOCXD  ,TAUOCYD  ,PHIOCD   ,              &
     &                      WSEMEAN  ,WSFMEAN
      USE YOWMESPAS, ONLY : LMESSPASS
      USE YOWMPP   , ONLY : IRANK    ,NPROC
      USE YOWPARAM , ONLY : NANG     ,NFRE     ,NIBLO    ,LL1D
      USE YOWSPEC, ONLY : NSTART   ,NEND     ,                          &
     &            WSWAVE   ,WDWAVE   ,UFRIC  ,  &
     &            Z0M    ,TAUW     ,TAUWDIR  ,  &
     &            Z0B      ,                    &
     &            CHNK  ,AIRD   ,WSTAR  ,       &
     &            FL1
      USE YOWSTAT  , ONLY : IPROPAGS ,LSUBGRID ,IREFRA   ,IDELPRO
      USE YOWTEST  , ONLY : IU06
      USE YOWWIND  , ONLY : FF_NEXT

      USE YOMHOOK  , ONLY : LHOOK,   DR_HOOK

! ----------------------------------------------------------------------

      IMPLICIT NONE

      INTEGER(KIND=JWIM) :: NPR, MAXLEN

      REAL(KIND=JWRB) :: ZHOOK_HANDLE

      LOGICAL, INTENT(IN) :: LWCUR

! ----------------------------------------------------------------------
 
      IF (LHOOK) CALL DR_HOOK('WVALLOC',0,ZHOOK_HANDLE)

!     1.  ALLOCATE NECESSARY ARRAYS
!         -------------------------

      IF (.NOT.ALLOCATED(TAUW)) ALLOCATE(TAUW(NSTART(IRANK):NEND(IRANK)))
      IF (.NOT.ALLOCATED(TAUWDIR)) ALLOCATE(TAUWDIR(NSTART(IRANK):NEND(IRANK)))
      IF (.NOT.ALLOCATED(WSWAVE)) ALLOCATE(WSWAVE(NSTART(IRANK):NEND(IRANK)))
      IF (.NOT.ALLOCATED(WDWAVE)) ALLOCATE(WDWAVE(NSTART(IRANK):NEND(IRANK)))
      IF (.NOT.ALLOCATED(UFRIC)) ALLOCATE(UFRIC(NSTART(IRANK):NEND(IRANK)))
      IF (.NOT.ALLOCATED(Z0M)) ALLOCATE(Z0M(NSTART(IRANK):NEND(IRANK)))
      IF (.NOT.ALLOCATED(Z0B)) ALLOCATE(Z0B(NSTART(IRANK):NEND(IRANK)))
      IF (.NOT.ALLOCATED(CHNK)) ALLOCATE(CHNK(NSTART(IRANK):NEND(IRANK)))
      IF (.NOT.ALLOCATED(AIRD)) ALLOCATE(AIRD(NSTART(IRANK):NEND(IRANK)))
      IF (.NOT.ALLOCATED(WSTAR)) ALLOCATE(WSTAR(NSTART(IRANK):NEND(IRANK)))

      IF (.NOT.ALLOCATED(CICOVER)) ALLOCATE(CICOVER(NSTART(IRANK):NEND(IRANK)))
      IF (.NOT.ALLOCATED(CITHICK)) ALLOCATE(CITHICK(NSTART(IRANK):NEND(IRANK)))

      IF (.NOT.ALLOCATED(CIWA)) ALLOCATE(CIWA(NSTART(IRANK):NEND(IRANK),NFRE))

      IF (.NOT.ALLOCATED(FL1)) THEN
        ALLOCATE(FL1(NSTART(IRANK):NEND(IRANK),NANG,NFRE))
        FL1(:,:,:) = 0.0_JWRB
      ENDIF

      IF (.NOT.ALLOCATED(USTOKES)) ALLOCATE(USTOKES(NSTART(IRANK):NEND(IRANK)))
      IF (.NOT.ALLOCATED(VSTOKES)) ALLOCATE(VSTOKES(NSTART(IRANK):NEND(IRANK)))

      IF (.NOT.ALLOCATED(PHIEPS)) THEN 
        ALLOCATE(PHIEPS(NSTART(IRANK):NEND(IRANK)))
        PHIEPS(:) = 0.0_JWRB
      ENDIF
      IF (.NOT.ALLOCATED(PHIAW)) THEN 
        ALLOCATE(PHIAW(NSTART(IRANK):NEND(IRANK)))
        PHIAW(:) = 0.0_JWRB
      ENDIF
      IF (.NOT.ALLOCATED(TAUOC)) THEN
        ALLOCATE(TAUOC(NSTART(IRANK):NEND(IRANK)))
        TAUOC(:) = 0.0_JWRB
      ENDIF

      IF (.NOT.ALLOCATED(TAUXD)) ALLOCATE(TAUXD(NSTART(IRANK):NEND(IRANK)))
      IF (.NOT.ALLOCATED(TAUYD)) ALLOCATE(TAUYD(NSTART(IRANK):NEND(IRANK)))
      IF (.NOT.ALLOCATED(TAUOCXD)) ALLOCATE(TAUOCXD(NSTART(IRANK):NEND(IRANK)))
      IF (.NOT.ALLOCATED(TAUOCYD)) ALLOCATE(TAUOCYD(NSTART(IRANK):NEND(IRANK)))
      IF (.NOT.ALLOCATED(PHIOCD)) ALLOCATE(PHIOCD(NSTART(IRANK):NEND(IRANK)))
      IF (.NOT.ALLOCATED(WSEMEAN)) ALLOCATE(WSEMEAN(NSTART(IRANK):NEND(IRANK)))
      IF (.NOT.ALLOCATED(WSFMEAN)) ALLOCATE(WSFMEAN(NSTART(IRANK):NEND(IRANK)))

      IF (.NOT.ALLOCATED(STRNMS)) THEN
        ALLOCATE(STRNMS(NSTART(IRANK):NEND(IRANK)))
        STRNMS(:) = 0.0_JWRB
      ENDIF

      IF (.NOT.ALLOCATED(U)) THEN
        ALLOCATE(U(NSTART(IRANK):NEND(IRANK)))
        U(:) = 0.0_JWRB
      ENDIF
      IF (.NOT.ALLOCATED(V)) THEN
        ALLOCATE(V(NSTART(IRANK):NEND(IRANK)))
        V(:) = 0.0_JWRB
      ENDIF


      IF (.NOT.ALLOCATED(FF_NEXT)) ALLOCATE(FF_NEXT(NSTART(IRANK):NEND(IRANK)))


      IF (LHOOK) CALL DR_HOOK('WVALLOC',1,ZHOOK_HANDLE)
 
      END SUBROUTINE WVALLOC
